<%= turbo_stream_from @room %>
<%= turbo_stream_from @client.id %>

<p>
  <% if @room.require_authentication %>
    Secure Room ID: <%= @room.external_room_id %>
  <% else %>
    Public Room ID: <%= @room.external_room_id %>
  <% end %>
</p>

<article
  class="room"
  data-controller="room"
  data-room-id-value="<%= @room.id %>"
  data-room-client-id-value="<%= @client.id %>"
>
  <div class="media" id="media">
    <div class="medium medium--local" data-controller="medium">
      <div>
        <video data-room-target="localMedium" data-medium-target="mediaElement" muted autoplay playsinline></video>
      </div>
      <% if @user %>
        <div>
          <p><%= @user.name %></p>
        </div>
      <% end %>
      <div class="medium-actions">
        <div class="enter" data-room-target="enter">
          <% if !@room.owner_broadcast_only %>
            <%= render "controls" %>
          <% else %>
            <% if @is_room_owner %>
              <%= render "controls" %>
            <% else %>
              <p>The owner of the room does not allow participants to share audio/video</p>
            <% end %>
          <% end %>
          <%= button_tag 'Enter',  data: { action: 'room#enter' }, class: 'btn btn-primary d-block' %>
        </div>
      </div>
    </div>
  </div>
</article>
